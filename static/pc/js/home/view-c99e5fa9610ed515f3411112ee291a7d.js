define(["jquery","underscore","home/preload"],function(e,t,n){function r(e,t){this.$el=e,this.viewHeight=0,this.$product=e.find(".product"),this.$text=e.find(".text"),this.options=t,this.bgSize=null,this.isLoaded=!1}return e.extend(r.prototype,{isReady:function(){return this.isLoaded},getHeight:function(){return this.viewHeight||this.$el.height()},setHeight:function(e){this.viewHeight=e},getZoomRatio:function(){var t=1920;return e(document).width()/t},load:function(){var e=this.$el,t=this,r=this.$product,i=this.$text,s=!1,o=!1,u=!1;n(e.find(".bg"),function(e){e.$el.attr("src",e.src).show(),s=!0,o&&u&&t.setReady()}),n(r.find("img"),function(e){r.data("originWidth",e.width),e.$el.attr("src",e.src),o=!0,s&&u&&t.setReady()}),n(i.find("img.t"),function(e){i.data("originWidth",e.width),e.$el.attr("src",e.src),u=!0,s&&u&&t.setReady()})},setReady:function(){this.isLoaded=!0,this.showImg(),this.setPosition("text","start"),this.setPosition("product","start")},showImg:function(){this.$product.find("img").addClass("fadeIn"),this.$text.find("img").addClass("fadeIn")},play:function(){this.setPosition("text","end"),this.setPosition("product","end")},playBack:function(){this.setPosition("text","start"),this.setPosition("product","start")},setPosition:function(t,n){var r=this["$"+t],i=e.extend({},this.options[t+"Config"]),s=i.animDirection,o=i.animDistance||350;delete i.animDirection,delete o;var u=e.extend({},i),a=this.getZoomRatio(),f=r.data("originWidth"),l={width:f*a};e.each(u,function(e,t){u[e]=t*a}),n=="start"&&s=="h"&&(u[u.left?"left":"right"]-=o),n=="start"&&s=="v"&&(u[u.top?"top":"bottom"]-=o),r[n=="start"?"removeClass":"addClass"]("t2s"),r.css(e.extend(l,u))}}),r});